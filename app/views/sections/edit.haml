.section-title
  %table
    %tr
      %td
        %span.serif-sc-font.big-font-size=link_to "#{@section.name} ", section_path(@section)
        %span.serif-sc-font.big-font-size='attributes'
      %td
        -if current_user && current_user.can_fully_manage?(@section.log_book)
          -Rails.logger.info "Show deleted attributes?: #{@show_deleted_attributes}"
          -if @show_deleted_properties
            %td=link_to "Hide deleted attributes", edit_section_path(@section.id), {class: "styled-button-blue-gray"}
          -else
            %td=link_to "Show deleted attributes", edit_section_path(@section.id, show_deleted: true), {class: "styled-button-blue-gray"}
        
#attributes_form.serif-sc-font.compact-form.right
  %table
    %tr
      %td
        =form_for @section do |section_form|
          %table
            %tr
              %td
              %th='Section Title'
              %td
            %tr
              %td
              %td=section_form.text_field :name
              %td
            %tr
              %td
              %th='Section Attributes'
              %td
            -@list_of_properties.each do |property|
              =section_form.fields_for :section_properties, property do |property_form|
                %tr
                  %td=property_form.object.data_type
                  %td=property_form.text_field :name
                  -if property.deleted?
                    %th.left=link_to 'Restore', untrash_section_section_property_path(@section.id, property.id), {method: :put, class: 'styled-button-blue-gray'}
                  -else
                    %th.left=link_to 'Delete', section_section_property_path(@section.id, property.id), {method: :delete, class: 'styled-button-dark-red'}

          =fields_for :section_properties do |new_section_properties_form|
            %td        
              %table
                %tr
                  %th='New Attributes (comma-separated)'
                %tr
                  %td=new_section_properties_form.text_field :new_section_property_names
                %tr
                  %th='Attribute Type'
                %tr
                  %td=collection_select new_section_properties_form.object, :data_type, SectionProperty.all_data_types, :to_s, :to_s
                %tr
                  %td
                    %br
                    %br
                    =section_form.submit "Update attributes", :class => 'styled-button-blue-gray'
    